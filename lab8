#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>

#define size 1000

int array[size];
int temp[size];

typedef struct {
    int high;
    int low;
} mer;

void merge(int high, int mid, int low) {
    int i, j, k;
    for (i = high, j = mid + 1, k = high; i <= mid && j <= low; k++) {
        if (array[i] <= array[j]) {
            temp[k] = array[i++];
        } else {
            temp[k] = array[j++];
        }
    }
    while (i <= mid) {
        temp[k++] = array[i++];
    }
    while (j <= low) {
        temp[k++] = array[j++];
    }
    for (k = high; k <= low; k++) {
        array[k] = temp[k];
    }
}

void *merge_sort(void *data) {
    mer *m = (mer *) data;
    int high = m->high;
    int low = m->low;
    if (high < low) {
        int mid = (high + low) / 2;

        pthread_t thread_high, thread_low;

        mer high_mer = {high, mid};
        mer low_mer = {mid + 1, low};

        pthread_create(&thread_high, NULL, merge_sort, &high_mer);
        pthread_create(&thread_low, NULL, merge_sort, &low_mer);

        pthread_join(thread_high, NULL);
        pthread_join(thread_low, NULL);

        merge(high, mid, low);
    }
    pthread_exit(NULL);
}

int main() {
    int n, i;
    pthread_t tid;

    printf("Enter No Of Elements: ");
    scanf("%d", &n);

    printf("Enter The Elements: ");
    for (i = 0; i < n; i++) {
        scanf("%d", &array[i]);
    }

    mer data = {0, n - 1};

    pthread_create(&tid, NULL, merge_sort, &data);
    pthread_join(tid, NULL);

    printf("Sorted elements: ");
    for (i = 0; i < n; i++) {
        printf("%d ", array[i]);
    }
    printf("\n");

    return 0;
}
